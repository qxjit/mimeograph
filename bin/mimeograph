#!/usr/bin/env ruby

ALWAYS_ON_OPTIONS = %w(
  -r
 --perms
 --times
 --links
 --hard-links
 --specials
 --devices
 --owner
 --group
)

command, source, dest, exclusions_file = ARGV

exclusion_options = if exclusions_file
                      ["--exclude-from=" + exclusions_file]
                    else
                      []
                    end

options = ALWAYS_ON_OPTIONS + exclusion_options + [source + "/", dest]

system "rsync", *options
